<div class="crud-usuario-root">
  <div class="crud-usuario-header">
    <h2>Gestión de Usuarios</h2>
    <button class="btn-primary" (click)="openAddModal()">Nuevo Usuario</button>
  </div>

  <div *ngIf="usuarios && usuarios.length > 0; else noUsuarios">
    <table class="crud-usuario-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Email</th>
          <th>Rol</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of usuarios">
          <td>{{ usuario.id }}</td>
          <td>{{ usuario.nombre }}</td>
          <td>{{ usuario.email }}</td>
          <td>{{ usuario.rol_nombre }}</td>
          <td>
            <button class="btn-edit" (click)="openEditModal(usuario)">Editar</button>
            <button class="btn-delete" (click)="deleteUsuario(usuario)">Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noUsuarios>
    <div class="crud-usuario-empty">
      No hay usuarios registrados.
    </div>
  </ng-template>

  <!-- Modal Formulario -->
  <div class="crud-usuario-modal" *ngIf="showModal">
    <div class="crud-usuario-modal-content">
      <h3>{{ editingUsuario ? 'Editar Usuario' : 'Nuevo Usuario' }}</h3>
      <form (ngSubmit)="saveUsuario()" #usuarioForm="ngForm">
        <div class="form-group">
          <label for="nombre">Nombre</label>
          <input id="nombre" name="nombre" [(ngModel)]="usuarioData.nombre" required />
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" [(ngModel)]="usuarioData.email" required />
        </div>
        <div class="form-group" *ngIf="!editingUsuario">
          <label for="password">Contraseña</label>
          <input id="password" name="password" type="password" [(ngModel)]="usuarioData.password" required />
        </div>
        <div class="form-group">
          <label for="rol_id">Rol</label>
          <select id="rol_id" name="rol_id" [(ngModel)]="usuarioData.rol_id" required>
            <option *ngFor="let rol of roles" [value]="rol.id">{{ rol.nombre }}</option>
          </select>
        </div>
        <div class="crud-usuario-modal-actions">
          <button type="submit" class="btn-primary">Guardar</button>
          <button type="button" class="btn-cancel" (click)="closeModal()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>